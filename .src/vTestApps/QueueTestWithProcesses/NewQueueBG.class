' Gambas class file

Inherits Task

Public Sub Main()

  Print Application.id, "***********************  Begin BackGround task"

  Dim qa As New ShmQueue(NewQueueTest.mqa, 0, True)

  Print Application.id, "Start BackGround loop"
  For i As Integer = 0 To 10
    qa.enqueue("Bye dolly")
    qa.enqueue(21)
    qa.enqueue(32.4)
    If i Mod 1000 = 0 Then Print Application.id, "********************************************", i
    While qa.Count
      Dim r As Variant = qa.pop()
    Wend
    Wait 0.1
  Next

Catch
  Print Error.text, Error.where

End
