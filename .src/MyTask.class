' Gambas class file

Inherits Task

Public Sub main()
Dim MyCollection As Collection
Dim MyObject As SharedObjectExample

'Print "Background task says ", SharedMem["text"], SharedMem["integer"], SharedMem["g"], "\n"

MyCollection = SharedMem["collection"]

'For Each d As Variant In MyCollection
 ' Print "Background >> ", MyCollection.key, "-->", d, "\n"
'Next

MyObject = SharedMem["sharedObject"]
'Print "Background >> Special object says >", MyObject.ThisNumber
'Print "BackGround >> Special object says >", MyObject.ThisString
'Print "Background >> Special object says >",
'For Each i As String In MyObject.ThisArray
'  Print i,
'Next
'Print "\nBackGround >> Special Object done print"
SharedMem["newguy"] = "This is the new guy"

'BadCollection = SharedMem["badcollection"]
'MySymbol = BadCollection["test"]
'Print "Background BadCollection =", MySymbol.SymName, "\n"

'Sleep 1



While SharedMem["counter"] < 1000
  
  'Print "Background >>  task says  g changed to ", SharedMem["g"], " Counter = ", SharedMem["counter"]
  
  Sleep 1
  
Wend

SharedMem["g"] += 1

'Print "Background >>  task says  g changed to ", SharedMem["g"], " Counter = ", SharedMem["counter"]

'Quit 0
End
